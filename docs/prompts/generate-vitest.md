Vitest を使った単体テストコードを作成してください。正常系と異常系の両方を含めてください。また、モックが必要な部分があれば適切にモック化してください

- この関数は外部 API を呼び出しているので、その部分はモックしてください。
- 境界値やエッジケースもカバーするようにしてください。
